<!doctype html>
<html lang="pt">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dashboard - Jogador</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background-color: #0d3331;
      color: #fff;
    }

    .header {
      background-color: #1a4d4b;
      padding: 15px 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 2px solid #2db88d;
    }

    .header h1 {
      margin: 0;
      font-size: 24px;
      color: #2db88d;
    }

    .user-info {
      display: flex;
      align-items: center;
      gap: 15px;
      position: relative;
    }

    .user-menu-trigger {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 15px;
      background-color: #0d3331;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .user-menu-trigger:hover {
      background-color: #1a4d4b;
    }

    .user-avatar {
      width: 35px;
      height: 35px;
      background: linear-gradient(135deg, #2db88d, #3ac9a1);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      font-weight: bold;
    }

    .user-dropdown {
      position: absolute;
      top: 55px;
      right: 0;
      background-color: #1a4d4b;
      border-radius: 10px;
      min-width: 200px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.4);
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all 0.3s;
      z-index: 1000;
      border: 1px solid #2db88d;
    }

    .user-dropdown.show {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .dropdown-header {
      padding: 15px;
      border-bottom: 1px solid #0d3331;
    }

    .dropdown-header p {
      margin: 0;
      font-size: 14px;
      color: #2db88d;
      font-weight: bold;
    }

    .dropdown-header span {
      font-size: 12px;
      color: #999;
    }

    .dropdown-menu {
      list-style: none;
      margin: 0;
      padding: 8px;
    }

    .dropdown-menu li {
      margin: 0;
    }

    .dropdown-menu button {
      width: 100%;
      padding: 12px 15px;
      background: transparent;
      border: none;
      color: #fff;
      text-align: left;
      cursor: pointer;
      border-radius: 6px;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: all 0.2s;
    }

    .dropdown-menu button:hover {
      background-color: #0d3331;
    }

    .dropdown-menu button.danger {
      color: #ff6b6b;
    }

    .dropdown-menu button.danger:hover {
      background-color: rgba(255,107,107,0.1);
    }

    .notif-badge {
      position: relative;
      background-color: #0d3331;
      padding: 8px 12px;
      border-radius: 5px;
      cursor: pointer;
    }

    .notif-badge .badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background-color: #ff6b6b;
      color: #fff;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      font-size: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }

    .btn-sair {
      background-color: #d73a49;
      color: #fff;
      border: none;
      padding: 8px 16px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
      display: none;
    }

    .btn-sair:hover {
      background-color: #ff6b6b;
    }

    .container {
      max-width: 1100px;
      margin: 30px auto;
      padding: 0 20px;
    }

    .welcome {
      background-color: #1a4d4b;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 30px;
    }

    .welcome h2 {
      margin: 0 0 10px 0;
      color: #2db88d;
    }

    .welcome p {
      margin: 0;
      color: #999;
    }

    .section-title {
      font-size: 20px;
      margin-bottom: 20px;
      color: #2db88d;
      border-bottom: 2px solid #1a4d4b;
      padding-bottom: 10px;
    }

    .convocatorias-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .convocatoria-card {
      background-color: #1a4d4b;
      padding: 20px;
      border-radius: 8px;
      border-left: 4px solid #2db88d;
    }

    .convocatoria-card.pendente {
      border-left-color: #ffa500;
    }

    .convocatoria-card.confirmado {
      border-left-color: #2ea043;
    }

    .convocatoria-card.recusado {
      border-left-color: #d73a49;
    }

    .convocatoria-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 15px;
    }

    .convocatoria-info h3 {
      margin: 0 0 8px 0;
      font-size: 18px;
    }

    .convocatoria-info p {
      margin: 5px 0;
      color: #999;
      font-size: 14px;
    }

    .status-badge {
      padding: 6px 12px;
      border-radius: 5px;
      font-size: 13px;
      font-weight: bold;
    }

    .status-badge.pendente {
      background-color: #4a3800;
      color: #ffa500;
    }

    .status-badge.confirmado {
      background-color: #1e4620;
      color: #2ea043;
    }

    .status-badge.recusado {
      background-color: #4a1a1a;
      color: #d73a49;
    }

    .convocatoria-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
      font-weight: bold;
    }

    .btn-confirmar {
      background-color: #2ea043;
      color: #fff;
    }

    .btn-confirmar:hover {
      background-color: #3fb950;
    }

    .btn-recusar {
      background-color: #d73a49;
      color: #fff;
    }

    .btn-recusar:hover {
      background-color: #ff6b6b;
    }

    .btn-talvez {
      background-color: #ffa500;
      color: #000;
    }

    .btn-talvez:hover {
      background-color: #ffb732;
    }

    .no-convocatorias {
      background-color: #1a4d4b;
      padding: 40px;
      text-align: center;
      border-radius: 8px;
      color: #999;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }

    .stat-card {
      background-color: #1a4d4b;
      padding: 20px;
      border-radius: 8px;
      text-align: center;
    }

    .stat-card h3 {
      margin: 0 0 10px 0;
      font-size: 32px;
      color: #2db88d;
    }

    .stat-card p {
      margin: 0;
      color: #999;
      font-size: 14px;
    }

    @media (max-width: 768px) {
      .header {
        flex-direction: column;
        gap: 15px;
      }
      
      .convocatoria-header {
        flex-direction: column;
        gap: 10px;
      }
      
      .convocatoria-actions {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>⚽ FutsalPro</h1>
    <div class="user-info">
      <div class="notif-badge" onclick="scrollToConvocatorias()">
        
        <span class="badge" id="notifCount">3</span>
      </div>
      
      <div class="user-menu-trigger" onclick="toggleUserMenu()">
        <div class="user-avatar" id="userAvatar">J</div>
        <span id="nomeUser">Jogador</span>
        <span style="font-size: 12px;">▼</span>
      </div>

      <!-- Dropdown Menu -->
      <div class="user-dropdown" id="userDropdown">
        <div class="dropdown-header">
          <p id="dropdownNome">Jogador</p>
          <span id="dropdownEmail">jogador@email.com</span>
        </div>
        <ul class="dropdown-menu">
          <li><button type="button" onclick="event.stopPropagation(); abrirPerfil();"> Meu Perfil</button></li>
          <li><button type="button" onclick="event.stopPropagation(); abrirConfiguracoes();"> Configurações</button></li>
          <li><button type="button" onclick="event.stopPropagation(); fazerLogout();" class="danger"> Terminar Sessão</button></li>
        </ul>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="welcome">
      <h2>Bem-vindo, <span id="nomeJogador">Jogador</span>!</h2>
      <p>Aqui podes ver e responder às convocatórias do teu treinador.</p>
    </div>

    <div class="stats-grid">
      <div class="stat-card">
        <h3 id="totalConvocatorias">5</h3>
        <p>Total de Convocatórias</p>
      </div>
      <div class="stat-card">
        <h3 id="totalConfirmadas">2</h3>
        <p>Confirmadas</p>
      </div>
      <div class="stat-card">
        <h3 id="totalPendentes">3</h3>
        <p>Pendentes</p>
      </div>
    </div>

    <h2 class="section-title" id="convocatoriasSection">Minhas Convocatórias</h2>
    
    <div class="convocatorias-list" id="listaConvocatorias">
      <!-- As convocatorias vao aparecer aqui -->
    </div>
  </div>

  <script>
    // Dados de exemplo (simulacao)
    let convocatorias = [
      {
        id: 1,
        tipo: 'Jogo',
        adversario: 'FC Porto B',
        data: '2025-10-20',
        hora: '19:00',
        local: 'Pavilhão Municipal',
        estado: 'pendente',
        observacoes: 'Chegar 30min antes para aquecimento'
      },
      {
        id: 2,
        tipo: 'Treino',
        adversario: null,
        data: '2025-10-18',
        hora: '20:30',
        local: 'Pavilhão do Clube',
        estado: 'confirmado',
        observacoes: 'Trazer equipamento completo'
      },
      {
        id: 3,
        tipo: 'Jogo',
        adversario: 'Sporting CP',
        data: '2025-10-22',
        hora: '15:00',
        local: 'Pavilhão João Rocha',
        estado: 'pendente',
        observacoes: 'Jogo importante para a classificação'
      },
      {
        id: 4,
        tipo: 'Treino',
        adversario: null,
        data: '2025-10-19',
        hora: '21:00',
        local: 'Pavilhão do Clube',
        estado: 'pendente',
        observacoes: 'Treino tático'
      },
      {
        id: 5,
        tipo: 'Jogo',
        adversario: 'Benfica',
        data: '2025-10-15',
        hora: '18:00',
        local: 'Pavilhão Fidelidade',
        estado: 'confirmado',
        observacoes: 'Derby importante'
      }
    ];

    // Verificar se esta logado
    window.onload = function() {
      let sessao = sessionStorage.getItem('sessaoUser');
      if(!sessao) {
        window.location.href = 'login.html';
        return;
      }
      
      let user = JSON.parse(sessao);
      if(user.tipo !== 'jogador') {
        alert('Acesso negado! Esta área é só para jogadores.');
        window.location.href = 'login.html';
        return;
      }
      
      document.getElementById('nomeUser').textContent = user.nome;
      document.getElementById('nomeJogador').textContent = user.nome;
      document.getElementById('dropdownNome').textContent = user.nome;
      document.getElementById('dropdownEmail').textContent = user.email;
      
      // Primeira letra do nome no avatar
      let primeiraLetra = user.nome.charAt(0).toUpperCase();
      document.getElementById('userAvatar').textContent = primeiraLetra;
      
      mostrarConvocatorias();
      atualizarStats();
    };

    function toggleUserMenu() {
      let dropdown = document.getElementById('userDropdown');
      dropdown.classList.toggle('show');
    }

    // Fechar dropdown ao clicar fora
    document.addEventListener('click', function(e) {
      let trigger = document.querySelector('.user-menu-trigger');
      let dropdown = document.getElementById('userDropdown');
      
      if(!trigger.contains(e.target) && !dropdown.contains(e.target)) {
        dropdown.classList.remove('show');
      }
    });

    function abrirPerfil() {
      alert('Página de perfil - Em desenvolvimento');
      document.getElementById('userDropdown').classList.remove('show');
    }

    function abrirConfiguracoes() {
      alert('Configurações - Em desenvolvimento');
      document.getElementById('userDropdown').classList.remove('show');
    }

    function fazerLogout() {
      console.log('Logout chamado!');
      document.getElementById('userDropdown').classList.remove('show');
      if(confirm('Tens a certeza que queres terminar sessão?')) {
        console.log('Confirmado! A remover sessão...');
        sessionStorage.clear();
        console.log('Sessão removida!');
        console.log('A redirecionar...');
        window.location.href = './login.html';
      } else {
        console.log('Cancelado pelo utilizador');
      }
    }

    function mostrarConvocatorias() {
      let lista = document.getElementById('listaConvocatorias');
      lista.innerHTML = '';
      
      if(convocatorias.length === 0) {
        lista.innerHTML = '<div class="no-convocatorias">Ainda não tens convocatórias.</div>';
        return;
      }
      
      convocatorias.forEach(function(conv) {
        let card = document.createElement('div');
        card.className = 'convocatoria-card ' + conv.estado;
        
        let statusTexto = '';
        if(conv.estado === 'pendente') statusTexto = 'Pendente';
        else if(conv.estado === 'confirmado') statusTexto = 'Confirmado';
        else if(conv.estado === 'recusado') statusTexto = 'Recusado';
        
        let titulo = conv.tipo;
        if(conv.adversario) {
          titulo += ' vs ' + conv.adversario;
        }
        
        card.innerHTML = `
          <div class="convocatoria-header">
            <div class="convocatoria-info">
              <h3>${titulo}</h3>
              <p> ${formatarData(conv.data)} às ${conv.hora}</p>
              <p> ${conv.local}</p>
              ${conv.observacoes ? '<p> ' + conv.observacoes + '</p>' : ''}
            </div>
            <div class="status-badge ${conv.estado}">${statusTexto}</div>
          </div>
          ${conv.estado === 'pendente' ? `
            <div class="convocatoria-actions">
              <button class="btn btn-confirmar" onclick="responderConvocatoria(${conv.id}, 'confirmado')">✓ Vou</button>
              <button class="btn btn-recusar" onclick="responderConvocatoria(${conv.id}, 'recusado')">✗ Não Vou</button>
            </div>
          ` : ''}
        `;
        
        lista.appendChild(card);
      });
    }

    function formatarData(dataStr) {
      let data = new Date(dataStr + 'T00:00:00');
      let dia = data.getDate();
      let mes = data.getMonth() + 1;
      let ano = data.getFullYear();
      return dia + '/' + mes + '/' + ano;
    }

    function responderConvocatoria(id, resposta) {
      for(let i = 0; i < convocatorias.length; i++) {
        if(convocatorias[i].id === id) {
          convocatorias[i].estado = resposta;
          break;
        }
      }
      
      mostrarConvocatorias();
      atualizarStats();
      
      let msg = resposta === 'confirmado' ? 'Presença confirmada!' : 'Marcaste falta.';
      alert(msg);
    }

    function atualizarStats() {
      let total = convocatorias.length;
      let confirmadas = 0;
      let pendentes = 0;
      
      convocatorias.forEach(function(conv) {
        if(conv.estado === 'confirmado') confirmadas++;
        else if(conv.estado === 'pendente') pendentes++;
      });
      
      document.getElementById('totalConvocatorias').textContent = total;
      document.getElementById('totalConfirmadas').textContent = confirmadas;
      document.getElementById('totalPendentes').textContent = pendentes;
      document.getElementById('notifCount').textContent = pendentes;
    }

    function scrollToConvocatorias() {
      document.getElementById('convocatoriasSection').scrollIntoView({ behavior: 'smooth' });
    }
  </script>
</body>
</html>